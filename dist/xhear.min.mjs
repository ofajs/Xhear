//! xhear - v7.4.2 https://github.com/kirakiray/Xhear  (c) 2018-2024 YAO
const e=()=>Math.random().toString(32).slice(2),t=Object.prototype.toString,r=e=>t.call(e).toLowerCase().replace(/(\[object )|(])/g,""),n=e=>{const t=r(e);return"array"===t||"object"===t};let s,i=0;const a=new Set;function o(t){const r=`t-${e()}`;return clearTimeout(s),s=setTimeout((()=>{i=0})),a.add(r),Promise.resolve().then((()=>{if(i++,i>5e4){a.clear();const e="nextTick exceeds thread limit";throw console.error({desc:e,lastCall:t}),new Error(e)}a.has(r)&&(t(),a.delete(r))})),r}const l=(e,t,r={})=>([...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)].forEach((n=>{const s=Object.getOwnPropertyDescriptor(t,n),{configurable:i,enumerable:a,writable:o,get:l,set:c,value:h}=s;"value"in s?e.hasOwnProperty(n)?e[n]=h:Object.defineProperty(e,n,{enumerable:a,configurable:i,writable:o,...r,value:h}):Object.defineProperty(e,n,{enumerable:a,configurable:i,...r,get:l,set:c})})),e);function c(e){try{e.xid}catch(e){return h(e)}return!1}function h(e){const t=e.stack.split(/\\n/)[0].toLowerCase();return!(!t.includes("proxy")||!t.includes("revoked"))}const u=e=>r(e).includes("function"),d=e=>e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase()));const f=e=>e.replace(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()})),p=(e,t)=>{const r=document.createElement("template");return r.content.append(e.cloneNode()),!!r.content.querySelector(t)};const g=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},m=(e,t)=>e instanceof HTMLTemplateElement?Array.from(e.content.querySelectorAll(t)):Array.from(e.querySelectorAll(t));const{assign:y,freeze:_}=Object;class b{constructor(e){y(this,e),_(this)}hasModified(e){if("array"===this.type)return this.path.includes(this.currentTarget.get(e));const t=e.split(".");if(this.currentTarget===this.target&&this.name===t[0])return!0;const r=w(this,t).indexOf(this.target);if(r>-1){const e=t.slice(r+1);return!e.length||this.name===e[0]}return this.path.includes(this.currentTarget[e])}hasReplaced(e){if("set"!==this.type)return!1;const t=e.split(".");if(this.target===this.currentTarget&&this.name===t[0])return!0;const r=w(this,t).indexOf(this.target);if(r>-1){return t.slice(r+1)[0]===this.name}return!1}}const w=(e,t)=>{const r=[],n=t.slice();let s=e.currentTarget;for(;n.length;){const e=n.shift();s&&(s=s[e]),r.push(s)}return r};class v extends Array{constructor(e){super(...e)}hasModified(e){return this.some((t=>t.hasModified(e)))}hasReplaced(e){return this.some((t=>t.hasReplaced(e)))}}const E=({type:e,currentTarget:t,target:r,name:n,value:s,oldValue:i,args:a,path:o=[]})=>{if(o&&o.includes(t))return void console.warn("Circular references appear");let l={type:e,target:r,name:n,oldValue:i,value:s};if("array"===e&&(delete l.value,l.args=a),t._hasWatchs){const e=new b({currentTarget:t,...l,path:[...o]});t[j].forEach((t=>{t(e)}))}t._update&&t.owner.forEach((e=>{E({currentTarget:e,...l,path:[t,...o]})}))};var x={watch(t){const r="w-"+e();return this[j].set(r,t),r},unwatch(e){return this[j].delete(e)},watchTick(e,t){return this.watch(function(e,t=0){let r=null,n=[];return function(...s){n.push(...s),t>0?(clearTimeout(r),r=setTimeout((()=>{e.call(this,n),n=[],r=null}),t)):null===r&&(r=1,o((()=>{r=null;const t=n.slice();n=[],e.call(this,t)})))}}((t=>{c(this)||(t=t.filter((e=>{try{e.path.forEach((e=>e.xid))}catch(e){return!1}return!0})),e(new v(t)))}),t||0))},refresh(e){const t={...e,type:"refresh",target:this,currentTarget:this};E(t)},watchUntil(e){return new Promise((t=>{let r;const n=this.watch(r=()=>{e()&&(this.unwatch(n),t(this))});r()}))}};const k=["push","pop","shift","unshift","splice","reverse","sort","fill","copyWithin"],T=Symbol("placeholder");const O={},A=Array.prototype;k.forEach((e=>{A[e]&&(O[e]=function(...t){const r=Array.from(this),s=A[e].apply(this[$],t),{deletedItems:i,addedItems:a}=function(e,t){const r=Array.from(t),n=Array.from(e),s=[],i=new Map,a=e.length;for(let t=0;t<a;t++){const n=e[t],i=r.indexOf(n);i>-1?r[i]=T:s.push(n)}const o=t.length;for(let e=0;e<o;e++){const r=t[e],s=n.indexOf(r);s>-1?n[s]=T:i.set(e,r)}return{deletedItems:s,addedItems:i}}(r,this);for(let[e,t]of a)C(t)?t._owner.push(this):n(t)&&(this.__unupdate=1,this[e]=t,delete this.__unupdate);for(let e of i)F(e,this);return E({type:"array",currentTarget:this,target:this,args:t,name:e,oldValue:r}),s===this[$]?this[M]:s})})),["concat","filter","slice","flatMap","map"].forEach((e=>{if("constructor"===e||k.includes(e))return;const t=Array.prototype[e];t instanceof Function&&(O[e]=function(...e){return t.call(Array.from(this),...e)})}));const{defineProperties:S,getOwnPropertyDescriptor:N,entries:L}=Object,$=Symbol("self"),M=Symbol("proxy"),j=Symbol("watchs"),H=Symbol("isxdata"),C=e=>e&&!!e[H];function P(t,r=I){let n,{proxy:s,revoke:i}=Proxy.revocable(this,r);return s._update=1,S(this,{xid:{value:t.xid||e()},_owner:{value:[]},owner:{configurable:!0,get(){return new Set(this._owner)}},[H]:{value:!0},[$]:{configurable:!0,get:()=>this},[M]:{configurable:!0,get:()=>s},[j]:{get:()=>n||(n=new Map)},_hasWatchs:{get:()=>!!n},_revoke:{value:i}}),Object.keys(t).forEach((e=>{const r=N(t,e);let{value:n,get:i,set:a}=r;i||a?S(this,{[e]:r}):s[e]=n})),s}class R extends Array{constructor(e){return super(),P.call(this,e)}revoke(){const e=this[$];e._onrevokes&&(e._onrevokes.forEach((e=>e())),e._onrevokes.length=0),e.__unupdate=1,e[j].clear(),L(this).forEach((([e,t])=>{C(t)&&(this[e]=null)})),e._owner.forEach((e=>{L(e).forEach((([t,r])=>{r===this&&(e[t]=null)}))})),delete e[$],delete e[M],e._revoke()}toJSON(){let e={},t=!0,r=-1;Object.keys(this).forEach((n=>{let s=this[n];/\D/.test(n)?t=!1:(n=parseInt(n))>r&&(r=n),C(s)&&(s=s.toJSON()),e[n]=s})),t&&(e.length=r+1,e=Array.from(e));const n=this.xid;return S(e,{xid:{get:()=>n}}),e}toString(){return JSON.stringify(this.toJSON())}extend(e,t){return l(this,e,t)}get(e){if(/\./.test(e)){const t=e.split(".");let r=this;for(let e=0,n=t.length;e<n;e++)try{r=r[t[e]]}catch(n){const s=new Error(`Failed to get data : ${t.slice(0,e).join(".")} \n${n.stack}`,{cause:n});throw Object.assign(s,{target:r}),s}return r}return this[e]}set(e,t){if(/\./.test(e)){const r=e.split("."),n=r.pop();let s=this;for(let e=0,t=r.length;e<t;e++)try{s=s[r[e]]}catch(t){const n=new Error(`Failed to get data : ${r.slice(0,e).join(".")} \n${t.stack}`,{cause:t});throw Object.assign(n,{target:s}),n}return s[n]=t}return this[e]=t}}R.prototype.extend({...x,...O},{enumerable:!1});const{defineProperties:D}=Object,B=({target:e,key:t,value:r,receiver:s,type:i,succeed:a})=>{const o=s[t];let l=r;if(C(l)){if(o===r)return!0;l._owner.push(s)}else if(n(r)){const n=Object.getOwnPropertyDescriptor(e,t);n&&!n.hasOwnProperty("value")||(l=new R(r),l._owner.push(s))}const c=o===r;!c&&C(o)&&F(o,s);const h=a(l);return!c&&!e.__unupdate&&E({type:i||"set",target:s,currentTarget:s,name:t,value:r,oldValue:o}),h},F=(e,t)=>{if(C(e)){const r=e._owner.indexOf(t);r>-1?e._owner.splice(r,1):console.error({desc:"This data is wrong, the owner has no boarding object at the time of deletion",target:t,mismatch:e})}},I={set(e,t,r,n){if("symbol"==typeof t)return Reflect.set(e,t,r,n);if(/^_/.test(t))return e.hasOwnProperty(t)?Reflect.set(e,t,r,n):D(e,{[t]:{writable:!0,configurable:!0,value:r}}),!0;try{return B({target:e,key:t,value:r,receiver:n,succeed:r=>Reflect.set(e,t,r,n)})}catch(e){const s=new Error(`failed to set ${t} \n ${e.stack}`,{cause:e});throw Object.assign(s,{key:t,value:r,target:n}),s}},deleteProperty:(e,t)=>/^_/.test(t)||"symbol"==typeof t?Reflect.deleteProperty(e,t):B({target:e,key:t,value:void 0,receiver:e[M],type:"delete",succeed:()=>Reflect.deleteProperty(e,t)})},q={set:(e,t,r,n)=>/\D/.test(String(t))?e[t]===r||("html"===t?Reflect.set(e,t,r,n):I.set(e,t,r,n)):Reflect.set(e,t,r,n),get:(e,t,r)=>/\D/.test(String(t))?Reflect.get(e,t,r):He(e.ele.children[t]),ownKeys(e){let t=Reflect.ownKeys(e),r=e.ele.children.length;for(let e=0;e<r;e++)t.push(String(e));return t},getOwnPropertyDescriptor:(e,t)=>"string"!=typeof t||/\D/.test(t)?Reflect.getOwnPropertyDescriptor(e,t):{enumerable:!0,configurable:!0}},V={beforeRender(){},render(){}},W=e=>e.__revokes||(e.__revokes=[]),J=(e,t)=>W(e).push(t),z=(e,t,r)=>{const n=`\nconst isRevokedErr = ${h.toString()}\nconst [$event] = $args;\nconst {data, errCall} = this;\ntry{\n  with(data){\n    return ${e};\n  }\n}catch(error){\n  if(isRevokedErr(error)){\n    return;\n  }\n  if(data.ele && !data.ele.isConnected){\n    return;\n  }\n  if(errCall){\n    const result = errCall(error);\n    if(result !== false){\n      console.error(error);\n    }\n  }else{\n    console.error(error);\n  }\n}\n`;return new Function("...$args",n).bind({data:t,...r})};function U({data:e,target:t,template:r,temps:n,isRenderSelf:s,...i}){const a=r&&r.innerHTML;a&&(t.innerHTML=a),V.beforeRender({target:t});const o=m(t,"xtext"),l=[],c=W(t);m(t,"style").forEach((t=>{const r=t.innerHTML;if(/data\(.+\)/.test(r)){const n=Array.from(new Set(r.match(/data\(.+?\)/g))).map((t=>{const r=t.replace(/data\((.+)\)/,"$1");return{dataExpr:t,func:z(r,e)}})),s=()=>{let e=r;n.forEach((({dataExpr:t,func:r})=>{e=e.replace(t,r())})),t.innerHTML!==e&&(t.innerHTML=e)};l.push(s);const i=()=>{n.length=0,g(l,s),g(W(t),i),g(c,i)};J(t,i),c.push(i)}})),o.forEach((t=>{const r=document.createTextNode(""),{parentNode:n}=t;n.insertBefore(r,t),n.removeChild(t);const s=z(t.getAttribute("expr"),e),i=()=>{const e=s();r.textContent!==String(e)&&(r.textContent=e)};l.push(i);const a=()=>{g(c,a),g(l,i),g(W(r),a)};c.push(a),J(r,a)}));const h=m(t,"[x-bind-data]");if(s&&p(t,"[x-bind-data]")&&h.unshift(t),h.forEach((r=>{const n=JSON.parse(r.getAttribute("x-bind-data")),s=He(r);for(let[i,a]of Object.entries(n))a.forEach((n=>{try{const{always:a}=s[i];let o,h=[];const u=()=>{const[r,a]=n,o=z(a,e,{errCall:e=>{const r=`Rendering of target element failed: ${s.ele.outerHTML} \n  ${e.stack}`;return console.error(r),console.error({stack:r,element:s.ele,target:t,error:e}),!1}});h=[r,o];const l=s[i](...h,{actionName:i,target:s,data:e,beforeArgs:n,args:h});return V.render({step:"refresh",args:n,name:i,target:s}),l};let d=()=>{const{revoke:t}=s[i];t&&t({actionName:i,target:s,data:e,beforeArgs:n,args:h,result:o}),g(c,d),g(W(r),d),g(l,u),d=null};a?l.push(u):o=u(),c.push(d),r!==t&&J(r,d)}catch(e){throw new Error(`Execution of the ${i} method reports an error: ${i}:${n[0]}="${n[1]}"  \n ${e.stack}`,{cause:e})}}));r.removeAttribute("x-bind-data"),r._bindingRendered=!0,r.dispatchEvent(new Event("binding-rendered"))})),t.__render_temps||function(e){if(!e)return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(n)||(t.__render_temps=n),l.length){if(t.__render_data&&t.__render_data!==e){const r=new Error("An old listener already exists and the rendering of this element may be wrong");throw Object.assign(r,{element:t,old:t.__render_data,new:e}),r}t.__render_data=e,l.forEach((e=>e()));const r=e.watchTick((t=>{l.length?l.forEach((e=>e())):e.unwatch(r)}))}V.render({step:"init",target:t})}const K=e=>{const{tagName:t}=e;if("TEMPLATE"!==t){if(t){const t={};Array.from(e.attributes).forEach((r=>{const n=/(.*):(.+)/.exec(r.name);if(!n)return;let[,s,i]=n;s||(s="prop");(t[s]||(t[s]=[])).push([i,r.value]),e.removeAttribute(r.name)}));Object.keys(t).length&&e.setAttribute("x-bind-data",JSON.stringify(t))}Array.from(e.children).forEach(K)}},X=(e,t,r)=>{const n=Array.from(e.content.querySelectorAll(t));return r&&n.forEach(r),n};let Y;const Z=t=>{let r={};const n={};X(t,"code",(t=>{const r=e();t.setAttribute("code-id",r),n[r]=t.innerHTML,t.innerHTML=""})),t.innerHTML=t.innerHTML.replace(/{{(.+?)}}/g,((e,t)=>`<xtext expr="${t}"></xtext>`));const s=t.getAttribute("name");if(s){const e=t.content.children;if(e.length>1){Y||(console.warn("Only one child element can be contained within a template element. If multiple child elements appear, the child elements will be rewrapped within a <div> element"),Y=1);const r=`wrapper-${s}`;t.innerHTML=`<div ${r} style="display:contents">${t.innerHTML}</div>`,console.warn(`The template "${s}" contains ${e.length} child elements that have been wrapped in a div element with attribute "${r}".`)}r[s]=t,t.remove()}X(t,"x-fill:not([name])",(t=>{if(t.querySelector("x-fill:not([name])"))throw new Error(`Don't fill unnamed x-fills with unnamed x-fill elements!!!\n${t.outerHTML}`);if(t.innerHTML.trim()){const r=`t${e()}`;t.setAttribute("name",r);const n=document.createElement("template");n.setAttribute("name",r),n.innerHTML=t.innerHTML,t.innerHTML="",t.appendChild(n)}})),X(t,"x-if,x-else-if,x-else",(e=>{const t=e.children[0];t&&"TEMPLATE"===t.tagName||(e.innerHTML=`<template condition>${e.innerHTML}</template>`)})),X(t,"template",(e=>{const t=Z(e);Object.keys(t).forEach((e=>{if(r[e])throw new Error(`Template "${e}" already exists`)})),r={...r,...t}})),Array.from(t.content.children).forEach((e=>K(e)));for(let[e,r]of Object.entries(n))X(t,`[code-id="${e}"]`,(e=>{e.removeAttribute("code-id"),e.innerHTML=r}));return r},G=e=>u(e)?e():e,Q={prop(...e){let[t,r]=e;if(1===e.length)return this[t];r=G(r),t=d(t),this.set(t,r)},attr(...e){let[t,r]=e;if(1===e.length)return this.ele.getAttribute(t);r=G(r),null===r?this.ele.removeAttribute(t):this.ele.setAttribute(t,r)},class(...e){let[t,r]=e;if(1===e.length)return this.ele.classList.contains(t);r=G(r),r?this.ele.classList.add(t):this.ele.classList.remove(t)}};Q.prop.always=!0,Q.attr.always=!0,Q.class.always=!0,Q.prop.revoke=({target:e,args:t,$ele:r,data:n})=>{const s=t[0];e.set(s,null)};const ee={sync(e,t,r){if(!r)throw new Error("Sync is only allowed within the renderer");[e,t]=r.beforeArgs,e=d(e),t=d(t);const{data:n}=r;if(n.get(t)instanceof Object){const e=`Object values cannot be synchronized using the sync function : ${t}`;throw console.log(e,n),new Error(e)}this[e]=n.get(t);const s=this.watch((r=>{if(r.hasModified(e))try{const r=this.get(e);n.set(t,r)}catch(e){}})),i=n.watch((r=>{if(r.hasModified(t))try{const r=n.get(t);this.set(e,r)}catch(e){}}));return()=>{this.unwatch(s),c(n)||n.unwatch(i)}}};function te(e,t,r){let n;if(r){const s=r.beforeArgs[1];/[^\d\w_\$\.]/.test(s)||(t=r.data.get(s).bind(r.data)),n=()=>this.ele.removeEventListener(e,t)}return{revoker:n,name:e,func:t}}ee.sync.revoke=e=>{e.result()};const re={on(...e){const{revoker:t,name:r,func:n}=te.call(this,...e);return this.ele.addEventListener(r,n),t||this},one(...e){const{revoker:t,name:r,func:n}=te.call(this,...e);let s=e=>{this.off(r,s),n(e)};return this.ele.addEventListener(r,s),t||this},off(e,t){return this.ele.removeEventListener(e,t),this},emit(e,t){const r={...t};let n,s;return r.hasOwnProperty("data")&&(n=r.data,delete r.data),e instanceof Event?s=e:e&&(s=new Event(e,{bubbles:!0,...r})),n&&(s.data=n),this.ele.dispatchEvent(s),this}};re.on.revoke=e=>{e.result()},re.one.revoke=e=>{e.result()};const ne=(e,t,r,...n)=>{const{children:s}=e;t<0&&(t+=e.children.length),void 0===r&&(r=e.children.length-t);const i=[];for(let e=t,n=t+r;e<n;e++){const t=s[e];i.push(t)}if(i.forEach((e=>e&&e.remove())),n.length){const r=document.createDocumentFragment();n.forEach((e=>r.append(Pe(e).ele)));const i=s[t];i?e.insertBefore(r,i):e.appendChild(r)}return i},se=["push","pop","shift","unshift","splice","reverse","sort","fill","copyWithin"],ie={push(...e){const{ele:t}=this;return ne(t,t.children.length,0,...e),E({type:"array",currentTarget:this,target:this,args:e,name:"push"}),t.children.length},pop(...e){const{ele:t}=this,r=ne(t,t.children.length-1,1,...e);return E({type:"array",currentTarget:this,target:this,args:e,name:"pop"}),He(r[0])},shift(...e){const{ele:t}=this,r=ne(t,0,1,...e);return E({type:"array",currentTarget:this,target:this,args:e,name:"shift"}),He(r[0])},unshift(...e){const{ele:t}=this;return ne(t,0,0,...e),E({type:"array",currentTarget:this,target:this,args:e,name:"unshift"}),t.children.length},splice(...e){const t=ne(this.ele,...e);return E({type:"array",currentTarget:this,target:this,args:e,name:"splice"}),t.map(He)},reverse(...e){const t=Array.from(this.ele.childNodes);ae.reverse.call(t,...e);const r=document.createDocumentFragment();return t.forEach((e=>{e.__internal=1,r.append(e)})),this.ele.append(r),t.forEach((e=>{delete e.__internal})),E({type:"array",currentTarget:this,target:this,args:e,name:"reverse"}),this},sort(...e){const t=Array.from(this.ele.children).map(He);ae.sort.call(t,...e);const r=document.createDocumentFragment();return t.forEach((e=>{e.ele.__internal=1,r.append(e.ele)})),this.ele.append(r),t.forEach((e=>{delete e.ele.__internal})),E({type:"array",currentTarget:this,target:this,args:e,name:"sort"}),this}},ae=Array.prototype;Object.keys(Object.getOwnPropertyDescriptors(ae)).forEach((e=>{if("constructor"===e||"length"===e||se.includes(e))return;const t=ae[e];u(t)&&(ie[e]=function(...e){return t.apply(Array.from(this.ele.children).map(He),e)})}));class oe{}for(let[e,t]of Object.entries(ie))Object.defineProperty(oe.prototype,e,{value:t});const le=e=>new R(e);Object.assign(le,{is:C});const{defineProperty:ce,assign:he}=Object,ue=(e,t)=>{const{ele:r}=t;e.forEach((e=>{if(e in r){let n=!1;ce(t,e,{enumerable:!0,get:()=>{let t=r[e];return n&&(/\D/.test(t)?n=!1:t=Number(t)),t},set:t=>{n="number"==typeof t,r[e]=t}})}}))},de=new Set(["input","textarea","select","option","button","label","fieldset","legend","form"]),fe=(e,t={})=>{const{name:r,type:n}=t,{ele:s}=e;let i=s[r];e.on(n,(()=>{E({type:"set",target:e,currentTarget:e,name:r,value:s[r],oldValue:i}),i=s[r]}))},pe=e=>{switch(e.attr("type")){case"file":ue(["multiple","files"],e),fe(e,{name:"files",type:"change"});break;case"checkbox":ue(["checked","multiple","value"],e),fe(e,{name:"checked",type:"change"});break;case"radio":ue(["checked","value"],e),fe(e,{name:"checked",type:"change"});break;default:ue(["placeholder","value"],e),fe(e,{name:"value",type:"input"})}},ge=(e,t)=>{const r={};return e.all(t).forEach((e=>{const{name:t,tag:n,ele:s}=e;if("input"===n)switch(e.type){case"checkbox":t in r||(r[t]=[]),s.checked&&r[t].push(s.value);break;case"radio":s.checked&&(r[t]=s.value);break;case"file":r[t]=s.files;break;default:r[t]=s.value}else if("textarea"===n)r[t]=s.value;else if("select"===n){const e=m(s,"option:checked");if(s.multiple)r[t]=e.map((e=>e.value||e.textContent));else{const[n]=e;r[t]=n.value||n.textContent}}else r[t]=e.value})),r};var me={formData(e,t={wait:200}){const r=le({});he(r,ge(this,e||"input,select,textarea"));const n=this.watchTick((t=>{const n=ge(this,e||"input,select,textarea");!function(e,t){for(let r of Object.keys(e))t.hasOwnProperty(r)||delete e[r];for(let[r,n]of Object.entries(t))e[r]=n}(r,n)}),t.wait),s=r.watchTick((t=>{!function(e,t,r){const n=e.all(t);Object.keys(r).forEach((e=>{const t=n.filter((t=>t.attr("name")===e));if(0===t.length)return;const s=r[e],i=t[0],a=i.attr("type");if(1===t.length){let e=!0;if("input"!==i.tag||"radio"!==a&&"checkbox"!==a||(e=!1),e)return void(i.value!==s&&(i.value=s))}t.forEach((e=>{switch(e.attr("type")){case"radio":e.value===s?e.checked=!0:e.checked=!1;break;case"checkbox":e.checked=s.includes(e.value)}}))}))}(this,e||"input,select,textarea",r)})),i=this,a=r.revoke;return r.extend({revoke(){i.unwatch(n),r.unwatch(s),a.call(this)}}),r}};const ye={set:(e,t,r,n)=>(e._ele.style[t]=r,Reflect.set(e,t,r,n),!0),get(e,t,r){if("length"===t)return 0;const{style:n}=e._ele;return Array.from(n).includes(t)?n[t]:getComputedStyle(e._ele)[t]}};class _e{constructor(e){const t={};Object.defineProperty(t,"_ele",{enumerable:!1,get:()=>e.ele});const{style:r}=e.ele;return Array.from(r).forEach((e=>{t[e]=r[e]})),e._css=new Proxy(t,ye)}}var be={get css(){return new _e(this)},set css(e){if("string"==r(e))return void(this.ele.style=e);let{style:t}=this,n=Object.keys(e);Array.from(t).forEach((e=>{n.includes(e)||(t[e]="")})),Object.assign(t,e)}};const we={},ve=(e={})=>{const t={tag:"",temp:"",data:{},proto:{},...e};let n,s,i;try{if(function(e){if("-"===e.charAt(0)||"-"===e.charAt(e.length-1))throw new Error(`The string "${e}" cannot start or end with "-"`);for(let t=0;t<e.length-1;t++)if("-"===e.charAt(t)&&"-"===e.charAt(t+1))throw new Error(`The string "${e}" cannot have consecutive "-" characters`);if(!e.includes("-"))throw new Error(`The string "${e}" must contain at least one "-"`)}(t.tag),t.data=xe(t.data),i=(a=d(t.tag)).charAt(0).toUpperCase()+a.slice(1),we[i])throw new Error(`Component ${i} already exists`);n=document.createElement("template"),n.innerHTML=t.temp,s=Z(n)}catch(e){throw new Error(`Register Component Error: ${t.tag} \n  ${e.stack}`,{cause:e})}var a;const o=e=>{let t;return t=e instanceof Array?[...e]:Object.keys(e),t},l=we[i]=class extends HTMLElement{constructor(...e){super(...e);const i=He(this);if(t.created&&t.created.call(i),t.attrs){const e=o(t.attrs);i.watchTick((t=>{e.forEach((e=>{if(t.hasModified(e)){const t=i[e],n=f(e),s=this.getAttribute(n);if(null==t)this.removeAttribute(n);else if(s!==t){let e=t;const i=r(t);if("number"===i&&s===String(t))return;if("object"===i&&(e=JSON.stringify(e),e===s))return;this.setAttribute(n,e)}}}))})),e.forEach((e=>{null!==i[e]&&void 0!==i[e]&&i[e]!==t.attrs[e]&&this.setAttribute(f(e),i[e])}))}(({defaults:e,ele:t,template:r,temps:n})=>{let s;try{const i={...xe(e.data),...e.attrs};e.attrs&&Object.keys(e.attrs).forEach((e=>{const r=t.getAttribute(f(e));null!=r&&(i[e]=r)})),s=He(t),e.proto&&s.extend(e.proto,{enumerable:!1});for(let[e,t]of Object.entries(i))s.hasOwnProperty(e)||(s[e]=t);if(e.temp){const e=t.attachShadow({mode:"open"});e.innerHTML=r.innerHTML,U({target:e,data:s,temps:n})}e.ready&&e.ready.call(s)}catch(e){throw new Error(`Render element error: ${t.tagName} \n  ${e.stack}`,{cause:e})}if(e.watch){const t=Object.entries(e.watch);s.watchTick((e=>{for(let[r,n]of t){const t=r.split(",");t.length>=2?t.some((t=>e.hasModified(t)))&&n.call(s,t.map((e=>s[e])),{watchers:e}):e.hasModified(r)&&n.call(s,s[r],{watchers:e})}}));for(let[e,r]of t){const t=e.split(",");t.length>=2?r.call(s,t.map((e=>s[e])),{}):r.call(s,s[e],{})}}})({defaults:t,ele:this,template:n,temps:s})}connectedCallback(){Ee(this)||t.attached&&t.attached.call(He(this))}disconnectedCallback(){Ee(this)||t.detached&&t.detached.call(He(this))}attributeChangedCallback(e,t,r){const n=He(this);/[^\d.]/.test(r)||"number"!=typeof n[e]||(r=Number(r)),n[d(e)]=r}static get observedAttributes(){return o(t.attrs||{}).map((e=>f(e)))}};if("loading"!==document.readyState)customElements.define(t.tag,l);else{const e="readystatechange";let r;document.addEventListener(e,r=()=>{customElements.define(t.tag,l),document.removeEventListener(e,r)})}};function Ee(e){let t=e;for(;t;){if(t.__internal)return!0;if(t=t.parentNode||t.host,!t||t.tagName&&"BODY"===t.tagName)break}return!1}function xe(e){if(e instanceof Set||e instanceof Map)throw new Error("The data of the registered component should contain only regular data types such as String, Number, Object and Array. for other data types, please set them after ready.");if(e instanceof Function)throw new Error("Please write the function in the 'proto' property object.");if("object"!=typeof e||null===e)return e;const t=Array.isArray(e)?[]:{};for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=xe(e[r]));return t}class ke extends Comment{constructor(e){const t="Fake Node"+(e?": "+e:"");super(` ${t} --end `),this._mark=e,this._inited=!1;const r=new Comment(` ${t} --start `);r.__fake_end=this,Object.defineProperty(this,"_start",{value:r})}init(){this._inited||(this.parentNode.insertBefore(this._start,this),this._inited=!0)}querySelector(e){return this.__searchEl(e,"find")}querySelectorAll(e){return this.__searchEl(e)}__searchEl(e,t="filter"){const r=this.parentNode;if(!r)return[];const n=this.children;return Array.from(r.querySelectorAll(e))[t]((e=>{let t=e;for(;;){if(n.includes(t))return!0;if(t=t.parentNode,!t)break}}))}insertBefore(e,t){const{parentNode:r}=this;Array.from(r.children).includes(t)?r.insertBefore(e,t):r.insertBefore(e,this)}appendChild(e){this.parentNode.insertBefore(e,this)}get children(){const e=[];let t=this;for(;;){if(t=t.previousSibling,!t)throw new Error("This is an unclosed FakeNode");if(t instanceof HTMLElement)e.unshift(t);else if(t===this._start)break}return e}get childNodes(){const e=[];let t=this;for(;;){if(t=t.previousSibling,!t)throw new Error("This is an unclosed FakeNode");if(t===this._start)break;e.unshift(t)}return e}set innerHTML(e){this.childNodes.forEach((e=>{e.remove()}));const t=document.createElement("template");t.innerHTML=e,Array.from(t.content.childNodes).forEach((e=>{this.appendChild(e)}))}get innerHTML(){const{children:e}=this;let t="";return e.forEach((e=>{t+=e.outerHTML+"\n"})),t}get nextElementSibling(){let e=this.nextSibling;return e?e.__fake_end?e.__fake_end:(!e||e instanceof Element||(e=e.nextElementSibling),e):null}get previousElementSibling(){const{_start:e}=this;let t=e.previousSibling;return t?t instanceof ke?t:e.previousElementSibling:null}}const Te=e=>{if(e.parentNode){const t=e.parentNode;Array.from(e.content.children).forEach((r=>{t.insertBefore(r,e)})),e.remove()}};if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent))V.beforeRender=({target:e})=>{let t=[];for(;t=Array.from(e.querySelectorAll('template[is="replace-temp"]')),t.length;)t.forEach((e=>{Te(e)}))};else{class e extends HTMLTemplateElement{constructor(){super(),this.init()}init(){Te(this)}connectedCallback(){this.init()}}customElements.define("replace-temp",e,{extends:"template"})}const Oe={data:{value:null,__rendered:!1},watch:{value(){this._bindend&&this.refreshValue()}},proto:{refreshValue(){clearTimeout(this._timer),this._timer=setTimeout((()=>{const e=[this,...this._others];let t=!1;e.forEach((e=>{t?e._clearContent():e.value||"x-else"===e.tag?(t=!0,e._renderContent()):e._clearContent()})),this._fake.parentNode&&He(this._fake.parentNode).refresh()}),0)},_renderContent(){if(this.__rendered)return;this.__rendered=!0;const e=Ae(this._fake);if(!e)return;const{target:t,data:r,temps:n}=e;c(r)||(this._fake.innerHTML=this.__originHTML,U({target:t,data:r,temps:n}),this.emit("rendered",{bubbles:!1}))},_clearContent(){this.__rendered&&(this.__rendered=!1,Re(this._fake),this._fake.innerHTML="",this.emit("clear",{bubbles:!1}))},init(){if(this._bindend)return;this._bindend=!0;const e=this._fake=new ke(this.tag);if(this.before(e),e.init(),this.remove(),"x-if"===this.tag){const t=this._others=[];let r=e;for(;r=r.nextElementSibling,r;)switch(r.tagName){case"X-ELSE":{const e=He(r);return e.init?e.init():e._if_ready=1,void t.push(e)}case"X-ELSE-IF":{const e=He(r);e._xif=this,t.push(e);break}}}}},created(){this.__originHTML=this.$("template[condition]").html,this.html=""},ready(){this.ele._bindingRendered?this.init():this.one("binding-rendered",(()=>this.init()))}};ve({tag:"x-if",...Oe}),ve({tag:"x-else-if",...Oe,watch:{value(){this._bindend&&this._xif&&this._xif.refreshValue()}}}),ve({tag:"x-else",...Oe,watch:{},ready(){this._if_ready&&this.init()}});const Ae=e=>{for(;e&&!e.__render_data;)e=e.parentNode;return e?{target:e,data:e.__render_data,temps:e.__render_temps}:null};ve({tag:"x-fill",data:{value:null},watch:{value(e,t){this.refreshValue(t?.watchers)}},proto:{refreshValue(e){const t=this.value;if(!this._bindend)return;const r=this._fake.children;if(!t)return r.forEach((e=>Re(e))),void(this._fake.innerHTML="");if(!(t instanceof Array))return console.warn(`The value of x-fill component must be of type Array, and the type of the current value is ${getType(t)}`),void(r&&r.forEach((e=>{Re(e),e.remove()})));const n=Ae(this._fake);if(!n)return;const{data:s,temps:i}=n,a=i[this._name],o=this.attr("fill-key")||"xid";if(r.length){if(e){if(!e.some((e=>e.path.length<=1)))return}const n=t.slice(),l=new Set(n.map((e=>{const t=e[o];return void 0===t?e:t}))),{parentNode:c}=this._fake;if("xid"!==o&&n.length!==l.size){const e="fill key duplicates";console.error(e),console.log(e,",its parent node is:",c,"host: ",He(c)?.host?.ele)}const h=[];for(let e=0,t=r.length;e<t;e++){const n=r[e],s=n._data_xid||n;l.has(s)?h.push(s):(Re(n),n.remove(),r.splice(e,1),t--,e--)}let u=this._fake._start;const d=[];let f=0;for(;u;){if(u===this._fake){n.length&&n.forEach((e=>{const t=Se(e,i,a,s.$host||s,f,o);f++,c.insertBefore(t.ele,u)}));break}if(!(u instanceof Element)){u=u.nextSibling;continue}const e=n.shift(),t=e instanceof Object,l=He(u).__item;if(void 0===e&&!n.length){d.push(u),u=u.nextSibling;continue}const p=h.indexOf(t?e[o]:e);if(p>-1){const n=r[p];(t?e[o]!==l.$data[o]:e!==l.$data)&&(n.__internal=1,c.insertBefore(n,u),delete n.__internal,u=n);const s=He(n);s.__item.$data!==e&&(s.__item.$data=e),s.__item.$index=f}else{const t=Se(e,i,a,s.$host||s,f,o);c.insertBefore(t.ele,u),u=t.ele}f++,u=u.nextSibling}d.length&&d.forEach((e=>{Re(e),e.remove()}))}else{const e=document.createDocumentFragment();t.forEach(((t,r)=>{const n=Se(t,i,a,s.$host||s,r,o);e.appendChild(n.ele)})),this._fake.appendChild(e)}this._fake.parentNode&&He(this._fake.parentNode).refresh(),this.emit("rendered",{bubbles:!1})},init(){if(this._bindend)return;this._bindend=!0;const e=this._fake=new ke("x-fill");this.before(e),e.init(),this.remove(),this.refreshValue()}},ready(){if(this._name=this.attr("name"),!this._name){const e="The target element does not have a template name to populate";throw console.log(e,this.ele),new Error(e)}this.ele._bindingRendered?this.init():this.one("binding-rendered",(()=>this.init()))}});const Se=(e,t,r,n,s,i)=>{const a=Pe(r.innerHTML),o=new R({$data:e,$ele:a,$host:n,$index:s});U({target:a.ele,data:o,temps:t,$host:n,isRenderSelf:!0});const l=a.ele.__revokes,c=()=>{g(l,c),o.revoke()};return l.push(c),a.__item=o,a.ele._data_xid=e[i]||e,a},{defineProperties:Ne}=Object,Le=({_this:e,ele:t,proxySelf:r})=>{const n={owner:{get(){const{parentNode:r}=t,{_owner:n}=e,s=r?[He(r),...n]:[...n];return new Set(s)}},ele:{get:()=>t}},s=t.tagName&&t.tagName.toLowerCase();s&&(n.tag={enumerable:!0,value:s}),Ne(e,n),(e=>{const{tag:t}=e;if(de.has(t))switch(ue(["type","name","disabled"],e),t){case"input":pe(e);break;case"textarea":ue(["value"],e),fe(e,{name:"value",type:"input"});break;case"option":ue(["selected","value"],e);break;case"select":{const{ele:t}=e;e.__unupdate=1,e.value=t.value,delete e.__unupdate,e.watch((()=>{t.value=e.value})),e.on("change",(()=>{e.value=t.value}))}}})(r)};class $e extends oe{constructor({ele:e}){super();const t=P.call(this,{},q);return Le({_this:this,ele:e,proxySelf:t}),e.__xhear__=t,t}get length(){return this.ele&&this.ele.children.length}$(e){let{ele:t}=this;t instanceof HTMLTemplateElement&&(t=t.content);const r=t.querySelector(e);return r?He(r):null}all(e){return m(this.ele,e).map(He)}extend(e,t){return l(this,e,t)}get text(){return this.ele.textContent}set text(e){this.ele.textContent=e}get html(){return this.ele.innerHTML}set html(e){this.ele.innerHTML=e}get classList(){return this.ele.classList}get data(){return this.ele.dataset}get shadow(){return He(this.ele.shadowRoot)}get root(){const e=this.ele.getRootNode();return e?He(e):null}get host(){let e=this.ele.getRootNode(),{host:t}=e;return t instanceof Node?He(t):null}get parent(){let{parentNode:e}=this.ele;return e&&e!==document?He(e):null}get parents(){const e=[];let t=this;for(;t.parent;)t=t.parent,e.push(t);return e}get next(){const e=this.ele.nextElementSibling;return e?He(e):null}after(e){const{next:t}=this;t?t.before(e):this.parent.push(e)}get nexts(){const{parent:e}=this,t=this.index;return e.filter(((e,r)=>r>t))}get prev(){const e=this.ele.previousElementSibling;return e?He(e):null}before(e){const t=Pe(e);this.parent.ele.insertBefore(t.ele,this.ele)}get prevs(){const{parent:e}=this,t=this.index;return e.filter(((e,r)=>r<t))}get siblings(){return this.parent.filter((e=>e!==this))}get index(){let{parentNode:e}=this.ele;return e?Array.prototype.indexOf.call(e.children,this.ele):null}get style(){return this.ele.style}get width(){return parseInt(getComputedStyle(this.ele).width)||0}get height(){return parseInt(getComputedStyle(this.ele).height)||0}get clientWidth(){return this.ele.clientWidth}get clientHeight(){return this.ele.clientHeight}get offsetWidth(){return this.ele.offsetWidth}get offsetHeight(){return this.ele.offsetHeight}get outerWidth(){let e=getComputedStyle(this.ele);return this.ele.offsetWidth+parseInt(e["margin-left"])+parseInt(e["margin-right"])}get outerHeight(){let e=getComputedStyle(this.ele);return this.ele.offsetHeight+parseInt(e["margin-top"])+parseInt(e["margin-bottom"])}is(e){return p(this.ele,e)}remove(){const{parent:e}=this;e&&e.splice(e.indexOf(this),1)}clone(e=!0){return He(this.ele.cloneNode(e))}wrap(e){const t=Pe(e),{ele:r}=this;if(!r.parentNode)throw new Error("The target has a sibling element, so you can't use unwrap");return r.parentNode.insertBefore(t.ele,r),r.__internal=1,t.ele.appendChild(r),delete r.__internal,this}unwrap(){const{ele:e}=this,t=e.parentNode;if(t.children.length>1)throw new Error("The element itself must have a parent");return e.__internal=1,t.parentNode.insertBefore(e,t),t.remove(),delete e.__internal,this}}const Me=R.prototype,je=$e.prototype;je.extend({get:Me.get,set:Me.set,toJSON:Me.toJSON,toString:Me.toString,...x,...re,...Q,...ee,...me},{enumerable:!1}),je.extend(be);const He=e=>e?e.__xhear__?e.__xhear__:new $e({ele:e}):null,Ce=document.createElement("template"),Pe=(e,t)=>{if(e instanceof $e)return e;if(e instanceof Node||e===window)return He(e);switch(r(e)){case"object":return(e=>{const t={...e};if(!e.tag)return null;const r=document.createElement(e.tag);delete t.tag;const n=He(r);return Object.assign(n,t),n})(e);case"string":return(e=>{Ce.innerHTML=e;const t=Ce.content.children[0]||Ce.content.childNodes[0];return Ce.innerHTML="",He(t)})(e)}},Re=e=>{e.__revokes&&Array.from(e.__revokes).forEach((e=>e&&e())),e.childNodes&&Array.from(e.childNodes).forEach((e=>{Re(e)}));const t=e?.shadowRoot?.__revokes;t&&[...t].forEach((e=>e()))};function De(e){if("string"===r(e)&&!/<.+>/.test(e)){const t=document.querySelector(e);return He(t)}return Pe(e)}Object.defineProperties(De,{extensions:{value:{}}}),Object.assign(De,{stanz:le,render:U,convert:Z,register:ve,nextTick:o,fn:$e.prototype,all:e=>m(document,e).map(He),frag:()=>De(document.createDocumentFragment())});export{De as default};
//# sourceMappingURL=xhear.min.mjs.map
