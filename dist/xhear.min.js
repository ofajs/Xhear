//! xhear - v7.5.0 https://github.com/ofajs/Xhear  (c) 2018-2024 YAO
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).$=t()}(this,(function(){"use strict";const e="https://ofajs.github.io/ofa-errors/errors",t={};globalThis.navigator&&navigator.language&&fetch(`${e}/${navigator.language.toLowerCase()}.json`).catch((()=>fetch(`${e}/default.json`))).then((e=>e.json())).catch((e=>(console.error(e),{}))).then((e=>{Object.assign(t,e)}));const r=(e,t,r)=>{const s=n(e,t);let a;return a=r?new Error(s,{cause:r}):new Error(s),a},n=(e,r)=>{if(!t[e])return`Error code: "${e}", please go to https://github.com/ofajs/ofa-errors to view the corresponding error information`;let n=t[e];if(r)for(let e in r)n=n.replace(new RegExp(`{${e}}`,"g"),r[e]);return n},s=()=>Math.random().toString(32).slice(2),a=Object.prototype.toString,i=e=>a.call(e).toLowerCase().replace(/(\[object )|(])/g,""),o=e=>{const t=i(e);return"array"===t||"object"===t},l={value:null};"undefined"!=typeof document&&(document.currentScript?l.value=document.currentScript.attributes.hasOwnProperty("debug"):l.value=!0);const c="nexttick_thread_limit";let h,u=0;const d=new Set;function f(e){if(clearTimeout(h),h=setTimeout((()=>{u=0})),l.value)return void Promise.resolve().then((()=>{if(u++,u>1e5)throw console.log(n(c),"lastCall => ",e),r(c);e()}));const t=`t-${s()}`;return d.add(t),Promise.resolve().then((()=>{if(u++,u>5e4)throw d.clear(),console.log(n(c),"lastCall => ",e),r(c);d.has(t)&&(e(),d.delete(t))})),t}const p=(e,t,r={})=>([...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)].forEach((n=>{const s=Object.getOwnPropertyDescriptor(t,n),{configurable:a,enumerable:i,writable:o,get:l,set:c,value:h}=s;"value"in s?e.hasOwnProperty(n)?e[n]=h:Object.defineProperty(e,n,{enumerable:i,configurable:a,writable:o,...r,value:h}):Object.defineProperty(e,n,{enumerable:i,configurable:a,...r,get:l,set:c})})),e);function g(e){try{e.xid}catch(e){return m(e)}return!1}function m(e){const t=e.stack.split(/\\n/)[0].toLowerCase();return!(!t.includes("proxy")||!t.includes("revoked"))}const _=e=>i(e).includes("function"),y=e=>e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase()));const b=e=>e.replace(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()})),v=(e,t)=>{const r=document.createElement("template");return r.content.append(e.cloneNode()),!!r.content.querySelector(t)};const w=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},x=(e,t)=>e instanceof HTMLTemplateElement?Array.from(e.content.querySelectorAll(t)):Array.from(e.querySelectorAll(t));const{assign:k,freeze:E}=Object;class T{constructor(e){k(this,e),E(this)}hasModified(e){if("array"===this.type)return this.path.includes(this.currentTarget.get(e));const t=e.split(".");if(this.currentTarget===this.target&&this.name===t[0])return!0;const r=O(this,t).indexOf(this.target);if(r>-1){const e=t.slice(r+1);return!e.length||this.name===e[0]}return this.path.includes(this.currentTarget[e])}hasReplaced(e){if("set"!==this.type)return!1;const t=e.split(".");if(this.target===this.currentTarget&&this.name===t[0])return!0;const r=O(this,t).indexOf(this.target);if(r>-1){return t.slice(r+1)[0]===this.name}return!1}}const O=(e,t)=>{const r=[],n=t.slice();let s=e.currentTarget;for(;n.length;){const e=n.shift();s&&(s=s[e]),r.push(s)}return r};class A extends Array{constructor(e){super(...e)}hasModified(e){return this.some((t=>t.hasModified(e)))}hasReplaced(e){return this.some((t=>t.hasReplaced(e)))}}const S=({type:e,currentTarget:t,target:r,name:n,value:s,oldValue:a,args:i,path:o=[]})=>{if(o&&o.includes(t))return void console.warn("Circular references appear");let l={type:e,target:r,name:n,oldValue:a,value:s};if("array"===e&&(delete l.value,l.args=i),t._hasWatchs){const e=new T({currentTarget:t,...l,path:[...o]});t[B].forEach((t=>{t(e)}))}t._update&&t.owner.forEach((e=>{S({currentTarget:e,...l,path:[t,...o]})}))};var L={watch(e){const t="w-"+s();return this[B].set(t,e),t},unwatch(e){return this[B].delete(e)},watchTick(e,t){return this.watch(function(e,t=0){let r=null,n=[];return function(...s){n.push(...s),t>0?(clearTimeout(r),r=setTimeout((()=>{e.call(this,n),n=[],r=null}),t)):null===r&&(r=1,f((()=>{r=null;const t=n.slice();n=[],e.call(this,t)})))}}((t=>{g(this)||(t=t.filter((e=>{try{e.path.forEach((e=>e.xid))}catch(e){return!1}return!0})),e(new A(t)))}),t||0))},refresh(e){const t={...e,type:"refresh",target:this,currentTarget:this};S(t)},watchUntil(e){return new Promise((t=>{let r;const n=this.watch(r=()=>{e()&&(this.unwatch(n),t(this))});r()}))}};const N=["push","pop","shift","unshift","splice","reverse","sort","fill","copyWithin"],j=Symbol("placeholder");const M={},H=Array.prototype;N.forEach((e=>{H[e]&&(M[e]=function(...t){const r=Array.from(this),n=H[e].apply(this[R],t),{deletedItems:s,addedItems:a}=function(e,t){const r=Array.from(t),n=Array.from(e),s=[],a=new Map,i=e.length;for(let t=0;t<i;t++){const n=e[t],a=r.indexOf(n);a>-1?r[a]=j:s.push(n)}const o=t.length;for(let e=0;e<o;e++){const r=t[e],s=n.indexOf(r);s>-1?n[s]=j:a.set(e,r)}return{deletedItems:s,addedItems:a}}(r,this);for(let[e,t]of a)q(t)?t._owner.push(this):o(t)&&(this.__unupdate=1,this[e]=t,delete this.__unupdate);for(let e of s)z(e,this);return S({type:"array",currentTarget:this,target:this,args:t,name:e,oldValue:r}),n===this[R]?this[D]:n})})),["concat","filter","slice","flatMap","map"].forEach((e=>{if("constructor"===e||N.includes(e))return;const t=Array.prototype[e];t instanceof Function&&(M[e]=function(...e){return t.call(Array.from(this),...e)})}));const{defineProperties:C,getOwnPropertyDescriptor:$,entries:P}=Object,R=Symbol("self"),D=Symbol("proxy"),B=Symbol("watchs"),I=Symbol("isxdata"),q=e=>e&&!!e[I];function V(e,t=U){let r,{proxy:n,revoke:a}=Proxy.revocable(this,t);return n._update=1,C(this,{xid:{value:e.xid||s()},_owner:{value:[]},owner:{configurable:!0,get(){return new Set(this._owner)}},[I]:{value:!0},[R]:{configurable:!0,get:()=>this},[D]:{configurable:!0,get:()=>n},[B]:{get:()=>r||(r=new Map)},_hasWatchs:{get:()=>!!r},_revoke:{value:a}}),Object.keys(e).forEach((t=>{const r=$(e,t);let{value:s,get:a,set:i}=r;a||i?C(this,{[t]:r}):n[t]=s})),n}class F extends Array{constructor(e){return super(),V.call(this,e)}revoke(){const e=this[R];e._onrevokes&&(e._onrevokes.forEach((e=>e())),e._onrevokes.length=0),e.__unupdate=1,e[B].clear(),P(this).forEach((([e,t])=>{q(t)&&(this[e]=null)})),e._owner.forEach((e=>{P(e).forEach((([t,r])=>{r===this&&(e[t]=null)}))})),delete e[R],delete e[D],e._revoke()}toJSON(){let e={},t=!0,r=-1;Object.keys(this).forEach((n=>{let s=this[n];/\D/.test(n)?t=!1:(n=parseInt(n))>r&&(r=n),q(s)&&(s=s.toJSON()),e[n]=s})),t&&(e.length=r+1,e=Array.from(e));const n=this.xid;return C(e,{xid:{get:()=>n}}),e}toString(){return JSON.stringify(this.toJSON())}extend(e,t){return p(this,e,t)}get(e){if(/\./.test(e)){const t=e.split(".");let s=this;for(let a=0,i=t.length;a<i;a++)try{s=s[t[a]]}catch(s){const i=["failed_to_get_data",{key:t.slice(0,a).join(".")}];throw console.log(n(...i),":",e,this,s),r(...i,s)}return s}return this[e]}set(e,t){if(/\./.test(e)){const s=e.split("."),a=s.pop();let i=this;for(let t=0,a=s.length;t<a;t++)try{i=i[s[t]]}catch(a){const i=["failed_to_get_data",{key:s.slice(0,t).join(".")}];throw console.log(n(...i),":",e,this,a),r(...i,a)}return i[a]=t}return this[e]=t}}F.prototype.extend({...L,...M},{enumerable:!1});const{defineProperties:W}=Object,J=({target:e,key:t,value:r,receiver:n,type:s,succeed:a})=>{const i=n[t];let l=r;if(q(l)){if(i===r)return!0;l._owner.push(n)}else if(o(r)){const s=Object.getOwnPropertyDescriptor(e,t);s&&!s.hasOwnProperty("value")||(l=new F(r),l._owner.push(n))}const c=i===r;!c&&q(i)&&z(i,n);const h=a(l);return!c&&!e.__unupdate&&S({type:s||"set",target:n,currentTarget:n,name:t,value:r,oldValue:i}),h},z=(e,t)=>{if(q(e)){const r=e._owner.indexOf(t);r>-1?e._owner.splice(r,1):console.error({desc:"This data is wrong, the owner has no boarding object at the time of deletion",target:t,mismatch:e})}},U={set(e,t,s,a){if("symbol"==typeof t)return Reflect.set(e,t,s,a);if(/^_/.test(t))return e.hasOwnProperty(t)?Reflect.set(e,t,s,a):W(e,{[t]:{writable:!0,configurable:!0,value:s}}),!0;try{return J({target:e,key:t,value:s,receiver:a,succeed:r=>Reflect.set(e,t,r,a)})}catch(a){const i=["failed_to_set_data",{key:t}];throw console.log(n(...i),t,e,s),r(...i,a)}},deleteProperty:(e,t)=>/^_/.test(t)||"symbol"==typeof t?Reflect.deleteProperty(e,t):J({target:e,key:t,value:void 0,receiver:e[D],type:"delete",succeed:()=>Reflect.deleteProperty(e,t)})},K={set:(e,t,r,n)=>/\D/.test(String(t))?e[t]===r||("html"===t?Reflect.set(e,t,r,n):U.set(e,t,r,n)):Reflect.set(e,t,r,n),get:(e,t,r)=>/\D/.test(String(t))?Reflect.get(e,t,r):Ie(e.ele.children[t]),ownKeys(e){let t=Reflect.ownKeys(e),r=e.ele.children.length;for(let e=0;e<r;e++)t.push(String(e));return t},getOwnPropertyDescriptor:(e,t)=>"string"!=typeof t||/\D/.test(t)?Reflect.getOwnPropertyDescriptor(e,t):{enumerable:!0,configurable:!0}},X={beforeRender(){},render(){}},Y=e=>e.__revokes||(e.__revokes=[]),Z=(e,t)=>Y(e).push(t),G=(e,t,r)=>{const n=`\nconst isRevokedErr = ${m.toString()}\nconst [$event] = $args;\nconst {data, errCall} = this;\ntry{\n  with(data){\n    return ${e};\n  }\n}catch(error){\n  if(isRevokedErr(error)){\n    return;\n  }\n  if(data.ele && !data.ele.isConnected){\n    return;\n  }\n  if(errCall){\n    const result = errCall(error);\n    if(result !== false){\n      console.error(error);\n    }\n  }else{\n    console.error(error);\n  }\n}\n`;return new Function("...$args",n).bind({data:t,...r})};function Q({data:e,target:t,template:n,temps:s,isRenderSelf:a,...i}){const o=n&&n.innerHTML;o&&(t.innerHTML=o),X.beforeRender({target:t});const l=x(t,"xtext"),c=[],h=Y(t);x(t,"style").forEach((t=>{const r=t.innerHTML;if(/data\(.+\)/.test(r)){const n=Array.from(new Set(r.match(/data\(.+?\)/g))).map((t=>{const r=t.replace(/data\((.+)\)/,"$1");return{dataExpr:t,func:G(r,e)}})),s=()=>{let e=r;n.forEach((({dataExpr:t,func:r})=>{e=e.replace(t,r())})),t.innerHTML!==e&&(t.innerHTML=e)};c.push(s);const a=()=>{n.length=0,w(c,s),w(Y(t),a),w(h,a)};Z(t,a),h.push(a)}})),l.forEach((t=>{const r=document.createTextNode(""),{parentNode:n}=t;n.insertBefore(r,t),n.removeChild(t);const s=G(t.getAttribute("expr"),e),a=()=>{const e=s();r.textContent!==String(e)&&(r.textContent=e)};c.push(a);const i=()=>{w(h,i),w(c,a),w(Y(r),i)};h.push(i),Z(r,i)}));const u=x(t,"[x-bind-data]");if(a&&v(t,"[x-bind-data]")&&u.unshift(t),u.forEach((n=>{const s=JSON.parse(n.getAttribute("x-bind-data")),a=Ie(n);for(let[i,o]of Object.entries(s))o.forEach((s=>{try{const{always:r}=a[i];let o,l=[];const u=()=>{const[r,n]=s,o=G(n,e,{errCall:e=>{const r=`Rendering of target element failed: ${a.ele.outerHTML} \n  ${e.stack}`;return console.error(r),console.error({stack:r,element:a.ele,target:t,error:e}),!1}});l=[r,o];const c=a[i](...l,{actionName:i,target:a,data:e,beforeArgs:s,args:l});return X.render({step:"refresh",args:s,name:i,target:a}),c};let d=()=>{const{revoke:t}=a[i];t&&t({actionName:i,target:a,data:e,beforeArgs:s,args:l,result:o}),w(h,d),w(Y(n),d),w(c,u),d=null};r?c.push(u):o=u(),h.push(d),n!==t&&Z(n,d)}catch(e){const t=r("xhear_eval",{name:i,arg0:s[0],arg1:s[1]},e);throw console.log(t,n),t}}));n.removeAttribute("x-bind-data"),n._bindingRendered=!0,n.dispatchEvent(new Event("binding-rendered"))})),t.__render_temps||function(e){if(!e)return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(s)||(t.__render_temps=s),c.length){if(t.__render_data&&t.__render_data!==e){const n=r("xhear_listen_already");throw console.log(n,{element:t,old:t.__render_data,new:e}),n}t.__render_data=e,c.forEach((e=>e()));const n=e.watchTick((t=>{c.length?c.forEach((e=>e())):e.unwatch(n)}))}X.render({step:"init",target:t})}const ee=e=>{const{tagName:t}=e;if("TEMPLATE"!==t){if(t){const t={};Array.from(e.attributes).forEach((r=>{const n=/(.*):(.+)/.exec(r.name);if(!n)return;let[,s,a]=n;s||(s="prop");(t[s]||(t[s]=[])).push([a,r.value]),e.removeAttribute(r.name)}));Object.keys(t).length&&e.setAttribute("x-bind-data",JSON.stringify(t))}Array.from(e.children).forEach(ee)}},te=(e,t,r)=>{const n=Array.from(e.content.querySelectorAll(t));return r&&n.forEach(r),n};let re;const ne=e=>{let t={};const n={};te(e,"code",(e=>{const t=s();e.setAttribute("code-id",t),n[t]=e.innerHTML,e.innerHTML=""})),e.innerHTML=e.innerHTML.replace(/{{(.+?)}}/g,((e,t)=>`<xtext expr="${t}"></xtext>`));const a=e.getAttribute("name");if(a){const r=e.content.children;if(r.length>1){re||(console.warn("Only one child element can be contained within a template element. If multiple child elements appear, the child elements will be rewrapped within a <div> element"),re=1);const t=`wrapper-${a}`;e.innerHTML=`<div ${t} style="display:contents">${e.innerHTML}</div>`,console.warn(`The template "${a}" contains ${r.length} child elements that have been wrapped in a div element with attribute "${t}".`)}t[a]=e,e.remove()}te(e,"x-fill:not([name])",(e=>{if(e.querySelector("x-fill:not([name])"))throw r("xhear_dbfill_noname");if(e.innerHTML.trim()){const t=`t${s()}`;e.setAttribute("name",t);const r=document.createElement("template");r.setAttribute("name",t),r.innerHTML=e.innerHTML,e.innerHTML="",e.appendChild(r)}})),te(e,"x-if,x-else-if,x-else",(e=>{const t=e.children[0];t&&"TEMPLATE"===t.tagName||(e.innerHTML=`<template condition>${e.innerHTML}</template>`)})),te(e,"template",(e=>{const n=ne(e);Object.keys(n).forEach((e=>{if(t[e])throw r("xhear_temp_exist",{name:e})})),t={...t,...n}})),Array.from(e.content.children).forEach((e=>ee(e)));for(let[t,r]of Object.entries(n))te(e,`[code-id="${t}"]`,(e=>{e.removeAttribute("code-id"),e.innerHTML=r}));return t},se=e=>_(e)?e():e,ae={prop(...e){let[t,r]=e;if(1===e.length)return this[t];r=se(r),t=y(t),this.set(t,r)},attr(...e){let[t,r]=e;if(1===e.length)return this.ele.getAttribute(t);r=se(r),null===r?this.ele.removeAttribute(t):this.ele.setAttribute(t,r)},class(...e){let[t,r]=e;if(1===e.length)return this.ele.classList.contains(t);r=se(r),r?this.ele.classList.add(t):this.ele.classList.remove(t)}};ae.prop.always=!0,ae.attr.always=!0,ae.class.always=!0,ae.prop.revoke=({target:e,args:t,$ele:r,data:n})=>{const s=t[0];e.set(s,null)};const ie={sync(e,t,n){if(!n)throw r("xhear_sync_no_options");[e,t]=n.beforeArgs,e=y(e),t=y(t);const{data:s}=n;if(s.get(t)instanceof Object){const e=r("xhear_sync_object_value",{targetName:t});throw console.log(e,s),e}this[e]=s.get(t);const a=this.watch((r=>{if(r.hasModified(e))try{const r=this.get(e);s.set(t,r)}catch(e){}})),i=s.watch((r=>{if(r.hasModified(t))try{const r=s.get(t);this.set(e,r)}catch(e){}}));return()=>{this.unwatch(a),g(s)||s.unwatch(i)}}};function oe(e,t,r){let n;if(r){const s=r.beforeArgs[1];/[^\d\w_\$\.]/.test(s)||(t=r.data.get(s).bind(r.data)),n=()=>this.ele.removeEventListener(e,t)}return{revoker:n,name:e,func:t}}ie.sync.revoke=e=>{e.result()};const le={on(...e){const{revoker:t,name:r,func:n}=oe.call(this,...e);return this.ele.addEventListener(r,n),t||this},one(...e){const{revoker:t,name:r,func:n}=oe.call(this,...e);let s=e=>{this.off(r,s),n(e)};return this.ele.addEventListener(r,s),t||this},off(e,t){return this.ele.removeEventListener(e,t),this},emit(e,t){const r={...t};let n,s;return r.hasOwnProperty("data")&&(n=r.data,delete r.data),e instanceof Event?s=e:e&&(s=new Event(e,{bubbles:!0,...r})),n&&(s.data=n),this.ele.dispatchEvent(s),this}};le.on.revoke=e=>{e.result()},le.one.revoke=e=>{e.result()};const ce=(e,t,r,...n)=>{const{children:s}=e;t<0&&(t+=e.children.length),void 0===r&&(r=e.children.length-t);const a=[];for(let e=t,n=t+r;e<n;e++){const t=s[e];a.push(t)}if(a.forEach((e=>e&&e.remove())),n.length){const r=document.createDocumentFragment();n.forEach((e=>r.append(Ve(e).ele)));const a=s[t];a?e.insertBefore(r,a):e.appendChild(r)}return a},he=["push","pop","shift","unshift","splice","reverse","sort","fill","copyWithin"],ue={push(...e){const{ele:t}=this;return ce(t,t.children.length,0,...e),S({type:"array",currentTarget:this,target:this,args:e,name:"push"}),t.children.length},pop(...e){const{ele:t}=this,r=ce(t,t.children.length-1,1,...e);return S({type:"array",currentTarget:this,target:this,args:e,name:"pop"}),Ie(r[0])},shift(...e){const{ele:t}=this,r=ce(t,0,1,...e);return S({type:"array",currentTarget:this,target:this,args:e,name:"shift"}),Ie(r[0])},unshift(...e){const{ele:t}=this;return ce(t,0,0,...e),S({type:"array",currentTarget:this,target:this,args:e,name:"unshift"}),t.children.length},splice(...e){const t=ce(this.ele,...e);return S({type:"array",currentTarget:this,target:this,args:e,name:"splice"}),t.map(Ie)},reverse(...e){const t=Array.from(this.ele.childNodes);de.reverse.call(t,...e);const r=document.createDocumentFragment();return t.forEach((e=>{e.__internal=1,r.append(e)})),this.ele.append(r),t.forEach((e=>{delete e.__internal})),S({type:"array",currentTarget:this,target:this,args:e,name:"reverse"}),this},sort(...e){const t=Array.from(this.ele.children).map(Ie);de.sort.call(t,...e);const r=document.createDocumentFragment();return t.forEach((e=>{e.ele.__internal=1,r.append(e.ele)})),this.ele.append(r),t.forEach((e=>{delete e.ele.__internal})),S({type:"array",currentTarget:this,target:this,args:e,name:"sort"}),this}},de=Array.prototype;Object.keys(Object.getOwnPropertyDescriptors(de)).forEach((e=>{if("constructor"===e||"length"===e||he.includes(e))return;const t=de[e];_(t)&&(ue[e]=function(...e){return t.apply(Array.from(this.ele.children).map(Ie),e)})}));class fe{}for(let[e,t]of Object.entries(ue))Object.defineProperty(fe.prototype,e,{value:t});const pe=e=>new F(e);Object.assign(pe,{is:q});const{defineProperty:ge,assign:me}=Object,_e=(e,t)=>{const{ele:r}=t;e.forEach((e=>{if(e in r){let n=!1;ge(t,e,{enumerable:!0,get:()=>{let t=r[e];return n&&(/\D/.test(t)?n=!1:t=Number(t)),t},set:t=>{n="number"==typeof t,r[e]=t}})}}))},ye=new Set(["input","textarea","select","option","button","label","fieldset","legend","form"]),be=(e,t={})=>{const{name:r,type:n}=t,{ele:s}=e;let a=s[r];e.on(n,(()=>{S({type:"set",target:e,currentTarget:e,name:r,value:s[r],oldValue:a}),a=s[r]}))},ve=e=>{switch(e.attr("type")){case"file":_e(["multiple","files"],e),be(e,{name:"files",type:"change"});break;case"checkbox":_e(["checked","multiple","value"],e),be(e,{name:"checked",type:"change"});break;case"radio":_e(["checked","value"],e),be(e,{name:"checked",type:"change"});break;default:_e(["placeholder","value"],e),be(e,{name:"value",type:"input"})}},we=(e,t)=>{const r={};return e.all(t).forEach((e=>{const{name:t,tag:n,ele:s}=e;if("input"===n)switch(e.type){case"checkbox":t in r||(r[t]=[]),s.checked&&r[t].push(s.value);break;case"radio":s.checked&&(r[t]=s.value);break;case"file":r[t]=s.files;break;default:r[t]=s.value}else if("textarea"===n)r[t]=s.value;else if("select"===n){const e=x(s,"option:checked");if(s.multiple)r[t]=e.map((e=>e.value||e.textContent));else{const[n]=e;r[t]=n.value||n.textContent}}else r[t]=e.value})),r};var xe={formData(e,t={wait:200}){const r=pe({});me(r,we(this,e||"input,select,textarea"));const n=this.watchTick((t=>{const n=we(this,e||"input,select,textarea");!function(e,t){for(let r of Object.keys(e))t.hasOwnProperty(r)||delete e[r];for(let[r,n]of Object.entries(t))e[r]=n}(r,n)}),t.wait),s=r.watchTick((t=>{!function(e,t,r){const n=e.all(t);Object.keys(r).forEach((e=>{const t=n.filter((t=>t.attr("name")===e));if(0===t.length)return;const s=r[e],a=t[0],i=a.attr("type");if(1===t.length){let e=!0;if("input"!==a.tag||"radio"!==i&&"checkbox"!==i||(e=!1),e)return void(a.value!==s&&(a.value=s))}t.forEach((e=>{switch(e.attr("type")){case"radio":e.value===s?e.checked=!0:e.checked=!1;break;case"checkbox":e.checked=s.includes(e.value)}}))}))}(this,e||"input,select,textarea",r)})),a=this,i=r.revoke;return r.extend({revoke(){a.unwatch(n),r.unwatch(s),i.call(this)}}),r}};const ke={set:(e,t,r,n)=>(e._ele.style[t]=r,Reflect.set(e,t,r,n),!0),get(e,t,r){if("length"===t)return 0;const{style:n}=e._ele;return Array.from(n).includes(t)?n[t]:getComputedStyle(e._ele)[t]}};class Ee{constructor(e){const t={};Object.defineProperty(t,"_ele",{enumerable:!1,get:()=>e.ele});const{style:r}=e.ele;return Array.from(r).forEach((e=>{t[e]=r[e]})),e._css=new Proxy(t,ke)}}var Te={get css(){return new Ee(this)},set css(e){if("string"==i(e))return void(this.ele.style=e);let{style:t}=this,r=Object.keys(e);Array.from(t).forEach((e=>{r.includes(e)||(t[e]="")})),Object.assign(t,e)}};const Oe={},Ae=(e={})=>{const t={tag:"",temp:"",data:{},proto:{},...e};let n,s,a;try{if(function(e){if(!e.includes("-"))throw r("xhear_tag_noline",{str:e});if("-"===e.charAt(0)||"-"===e.charAt(e.length-1))throw r("xhear_validate_tag",{str:e});for(let t=0;t<e.length-1;t++)if("-"===e.charAt(t)&&"-"===e.charAt(t+1))throw r("xhear_validate_tag",{str:e})}(t.tag),t.data=Le(t.data,t.tag),a=(o=y(t.tag)).charAt(0).toUpperCase()+o.slice(1),Oe[a])throw r("xhear_register_exists",{name:a});n=document.createElement("template"),n.innerHTML=t.temp,s=ne(n)}catch(e){throw r("xhear_register_err",{tag:t.tag},e)}var o;const l=e=>{let t;return t=e instanceof Array?[...e]:Object.keys(e),t},c=Oe[a]=class extends HTMLElement{constructor(...e){super(...e);const a=Ie(this);if(t.created&&t.created.call(a),t.attrs){const e=l(t.attrs);a.watchTick((t=>{e.forEach((e=>{if(t.hasModified(e)){const t=a[e],r=b(e),n=this.getAttribute(r);if(null==t)this.removeAttribute(r);else if(n!==t){let e=t;const s=i(t);if("number"===s&&n===String(t))return;if("object"===s&&(e=JSON.stringify(e),e===n))return;this.setAttribute(r,e)}}}))})),e.forEach((e=>{null!==a[e]&&void 0!==a[e]&&a[e]!==t.attrs[e]&&this.setAttribute(b(e),a[e])}))}(({defaults:e,ele:t,template:n,temps:s})=>{let a;try{const r={...Le(e.data,e.tag),...e.attrs};e.attrs&&Object.keys(e.attrs).forEach((e=>{const n=t.getAttribute(b(e));null!=n&&(r[e]=n)})),a=Ie(t),e.proto&&a.extend(e.proto,{enumerable:!1});for(let[e,t]of Object.entries(r))a.hasOwnProperty(e)||(a[e]=t);if(e.temp){const e=t.attachShadow({mode:"open"});e.innerHTML=n.innerHTML,Q({target:e,data:a,temps:s})}e.ready&&e.ready.call(a)}catch(e){throw r("xhear_reander_err",{tag:t.tagName},e)}if(e.watch){const t=Object.entries(e.watch);a.watchTick((e=>{for(let[r,n]of t){const t=r.split(",");t.length>=2?t.some((t=>e.hasModified(t)))&&n.call(a,t.map((e=>a[e])),{watchers:e}):e.hasModified(r)&&n.call(a,a[r],{watchers:e})}}));for(let[e,r]of t){const t=e.split(",");t.length>=2?r.call(a,t.map((e=>a[e])),{}):r.call(a,a[e],{})}}})({defaults:t,ele:this,template:n,temps:s})}connectedCallback(){Se(this)||t.attached&&t.attached.call(Ie(this))}disconnectedCallback(){Se(this)||t.detached&&t.detached.call(Ie(this))}attributeChangedCallback(e,t,r){const n=Ie(this);/[^\d.]/.test(r)||"number"!=typeof n[e]||(r=Number(r)),n[y(e)]=r}static get observedAttributes(){return l(t.attrs||{}).map((e=>b(e)))}};if("loading"!==document.readyState)customElements.define(t.tag,c);else{const e="readystatechange";let r;document.addEventListener(e,r=()=>{customElements.define(t.tag,c),document.removeEventListener(e,r)})}};function Se(e){let t=e;for(;t;){if(t.__internal)return!0;if(t=t.parentNode||t.host,!t||t.tagName&&"BODY"===t.tagName)break}return!1}function Le(e,t=""){if(e instanceof Set||e instanceof Map)throw r("xhear_regster_data_noset",{tag:t});if(e instanceof Function)throw r("xhear_regster_data_nofunc",{tag:t});if("object"!=typeof e||null===e)return e;const n=Array.isArray(e)?[]:{};for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=Le(e[r],t));return n}class Ne extends Comment{constructor(e){const t="Fake Node"+(e?": "+e:"");super(` ${t} --end `),this._mark=e,this._inited=!1;const r=new Comment(` ${t} --start `);r.__fake_end=this,Object.defineProperty(this,"_start",{value:r})}init(){this._inited||(this.parentNode.insertBefore(this._start,this),this._inited=!0)}querySelector(e){return this.__searchEl(e,"find")}querySelectorAll(e){return this.__searchEl(e)}__searchEl(e,t="filter"){const r=this.parentNode;if(!r)return[];const n=this.children;return Array.from(r.querySelectorAll(e))[t]((e=>{let t=e;for(;;){if(n.includes(t))return!0;if(t=t.parentNode,!t)break}}))}insertBefore(e,t){const{parentNode:r}=this;Array.from(r.children).includes(t)?r.insertBefore(e,t):r.insertBefore(e,this)}appendChild(e){this.parentNode.insertBefore(e,this)}get children(){const e=[];let t=this;for(;;){if(t=t.previousSibling,!t)throw r("xhear_fakenode_unclose",{name:"children"});if(t instanceof HTMLElement)e.unshift(t);else if(t===this._start)break}return e}get childNodes(){const e=[];let t=this;for(;;){if(t=t.previousSibling,!t)throw r("xhear_fakenode_unclose",{name:"childNodes"});if(t===this._start)break;e.unshift(t)}return e}set innerHTML(e){this.childNodes.forEach((e=>{e.remove()}));const t=document.createElement("template");t.innerHTML=e,Array.from(t.content.childNodes).forEach((e=>{this.appendChild(e)}))}get innerHTML(){const{children:e}=this;let t="";return e.forEach((e=>{t+=e.outerHTML+"\n"})),t}get nextElementSibling(){let e=this.nextSibling;return e?e.__fake_end?e.__fake_end:(!e||e instanceof Element||(e=e.nextElementSibling),e):null}get previousElementSibling(){const{_start:e}=this;let t=e.previousSibling;return t?t instanceof Ne?t:e.previousElementSibling:null}}const je=e=>{if(e.parentNode){const t=e.parentNode;Array.from(e.content.children).forEach((r=>{t.insertBefore(r,e)})),e.remove()}};if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent))X.beforeRender=({target:e})=>{let t=[];for(;t=Array.from(e.querySelectorAll('template[is="replace-temp"]')),t.length;)t.forEach((e=>{je(e)}))};else{class e extends HTMLTemplateElement{constructor(){super(),this.init()}init(){je(this)}connectedCallback(){this.init()}}customElements.define("replace-temp",e,{extends:"template"})}const Me={data:{value:null,__rendered:!1},watch:{value(){this._bindend&&this.refreshValue()}},proto:{refreshValue(){clearTimeout(this._timer),this._timer=setTimeout((()=>{const e=[this,...this._others];let t=!1;e.forEach((e=>{t?e._clearContent():e.value||"x-else"===e.tag?(t=!0,e._renderContent()):e._clearContent()})),this._fake.parentNode&&Ie(this._fake.parentNode).refresh()}),0)},_renderContent(){if(this.__rendered)return;this.__rendered=!0;const e=He(this._fake);if(!e)return;const{target:t,data:r,temps:n}=e;g(r)||(this._fake.innerHTML=this.__originHTML,Q({target:t,data:r,temps:n}),this.emit("rendered",{bubbles:!1}))},_clearContent(){this.__rendered&&(this.__rendered=!1,Fe(this._fake),this._fake.innerHTML="",this.emit("clear",{bubbles:!1}))},init(){if(this._bindend)return;this._bindend=!0;const e=this._fake=new Ne(this.tag);if(this.before(e),e.init(),this.remove(),"x-if"===this.tag){const t=this._others=[];let r=e;for(;r=r.nextElementSibling,r;)switch(r.tagName){case"X-ELSE":{const e=Ie(r);return e.init?e.init():e._if_ready=1,void t.push(e)}case"X-ELSE-IF":{const e=Ie(r);e._xif=this,t.push(e);break}}}}},created(){this.__originHTML=this.$("template[condition]").html,this.html=""},ready(){this.ele._bindingRendered?this.init():this.one("binding-rendered",(()=>this.init()))}};Ae({tag:"x-if",...Me}),Ae({tag:"x-else-if",...Me,watch:{value(){this._bindend&&this._xif&&this._xif.refreshValue()}}}),Ae({tag:"x-else",...Me,watch:{},ready(){this._if_ready&&this.init()}});const He=e=>{for(;e&&!e.__render_data;)e=e.parentNode;return e?{target:e,data:e.__render_data,temps:e.__render_temps}:null};Ae({tag:"x-fill",data:{value:null},watch:{value(e,t){this.refreshValue(t?.watchers)}},proto:{refreshValue(e){const t=this.value;if(!this._bindend)return;const r=this._fake.children;if(!t)return r.forEach((e=>Fe(e))),void(this._fake.innerHTML="");if(!(t instanceof Array))return console.warn(`The value of x-fill component must be of type Array, and the type of the current value is ${getType(t)}`),void(r&&r.forEach((e=>{Fe(e),e.remove()})));const n=He(this._fake);if(!n)return;const{data:s,temps:a}=n,i=a[this._name],o=this.attr("fill-key")||"xid";if(r.length){if(e){if(!e.some((e=>e.path.length<=1)))return}const n=t.slice(),l=new Set(n.map((e=>{const t=e[o];return void 0===t?e:t}))),{parentNode:c}=this._fake;if("xid"!==o&&n.length!==l.size){const e="fill key duplicates";console.error(e),console.log(e,",its parent node is:",c,"host: ",Ie(c)?.host?.ele)}const h=[];for(let e=0,t=r.length;e<t;e++){const n=r[e],s=n._data_xid||n;l.has(s)?h.push(s):(Fe(n),n.remove(),r.splice(e,1),t--,e--)}let u=this._fake._start;const d=[];let f=0;for(;u;){if(u===this._fake){n.length&&n.forEach((e=>{const t=Ce(e,a,i,s.$host||s,f,o);f++,c.insertBefore(t.ele,u)}));break}if(!(u instanceof Element)){u=u.nextSibling;continue}const e=n.shift(),t=e instanceof Object,l=Ie(u).__item;if(void 0===e&&!n.length){d.push(u),u=u.nextSibling;continue}const p=h.indexOf(t?e[o]:e);if(p>-1){const n=r[p];(t?e[o]!==l.$data[o]:e!==l.$data)&&(n.__internal=1,c.insertBefore(n,u),delete n.__internal,u=n);const s=Ie(n);s.__item.$data!==e&&(s.__item.$data=e),s.__item.$index=f}else{const t=Ce(e,a,i,s.$host||s,f,o);c.insertBefore(t.ele,u),u=t.ele}f++,u=u.nextSibling}d.length&&d.forEach((e=>{Fe(e),e.remove()}))}else{const e=document.createDocumentFragment();t.forEach(((t,r)=>{const n=Ce(t,a,i,s.$host||s,r,o);e.appendChild(n.ele)})),this._fake.appendChild(e)}this._fake.parentNode&&Ie(this._fake.parentNode).refresh(),this.emit("rendered",{bubbles:!1})},init(){if(this._bindend)return;this._bindend=!0;const e=this._fake=new Ne("x-fill");this.before(e),e.init(),this.remove(),this.refreshValue()}},ready(){if(this._name=this.attr("name"),!this._name){const e=r("xhear_fill_tempname",{name:this._name});throw console.log(e,this.ele),e}this.ele._bindingRendered?this.init():this.one("binding-rendered",(()=>this.init()))}});const Ce=(e,t,r,n,s,a)=>{const i=Ve(r.innerHTML),o=new F({$data:e,$ele:i,$host:n,$index:s});Q({target:i.ele,data:o,temps:t,$host:n,isRenderSelf:!0});const l=i.ele.__revokes,c=()=>{w(l,c),o.revoke()};return l.push(c),i.__item=o,i.ele._data_xid=e[a]||e,i},{defineProperties:$e}=Object,Pe=({_this:e,ele:t,proxySelf:r})=>{const n={owner:{get(){const{parentNode:r}=t,{_owner:n}=e,s=r?[Ie(r),...n]:[...n];return new Set(s)}},ele:{get:()=>t}},s=t.tagName&&t.tagName.toLowerCase();s&&(n.tag={enumerable:!0,value:s}),$e(e,n),(e=>{const{tag:t}=e;if(ye.has(t))switch(_e(["type","name","disabled"],e),t){case"input":ve(e);break;case"textarea":_e(["value"],e),be(e,{name:"value",type:"input"});break;case"option":_e(["selected","value"],e);break;case"select":{const{ele:t}=e;e.__unupdate=1,e.value=t.value,delete e.__unupdate,e.watch((()=>{t.value=e.value})),e.on("change",(()=>{e.value=t.value}))}}})(r)};class Re extends fe{constructor({ele:e}){super();const t=V.call(this,{},K);return Pe({_this:this,ele:e,proxySelf:t}),e.__xhear__=t,t}get length(){return this.ele&&this.ele.children.length}$(e){let{ele:t}=this;t instanceof HTMLTemplateElement&&(t=t.content);const r=t.querySelector(e);return r?Ie(r):null}all(e){return x(this.ele,e).map(Ie)}extend(e,t){return p(this,e,t)}get text(){return this.ele.textContent}set text(e){this.ele.textContent=e}get html(){return this.ele.innerHTML}set html(e){this.ele.innerHTML=e}get classList(){return this.ele.classList}get data(){return this.ele.dataset}get shadow(){return Ie(this.ele.shadowRoot)}get root(){const e=this.ele.getRootNode();return e?Ie(e):null}get host(){let e=this.ele.getRootNode(),{host:t}=e;return t instanceof Node?Ie(t):null}get parent(){let{parentNode:e}=this.ele;return e&&e!==document?Ie(e):null}get parents(){const e=[];let t=this;for(;t.parent;)t=t.parent,e.push(t);return e}get next(){const e=this.ele.nextElementSibling;return e?Ie(e):null}after(e){const{next:t}=this;t?t.before(e):this.parent.push(e)}get nexts(){const{parent:e}=this,t=this.index;return e.filter(((e,r)=>r>t))}get prev(){const e=this.ele.previousElementSibling;return e?Ie(e):null}before(e){const t=Ve(e);this.parent.ele.insertBefore(t.ele,this.ele)}get prevs(){const{parent:e}=this,t=this.index;return e.filter(((e,r)=>r<t))}get siblings(){return this.parent.filter((e=>e!==this))}get index(){let{parentNode:e}=this.ele;return e?Array.prototype.indexOf.call(e.children,this.ele):null}get style(){return this.ele.style}get width(){return parseInt(getComputedStyle(this.ele).width)||0}get height(){return parseInt(getComputedStyle(this.ele).height)||0}get clientWidth(){return this.ele.clientWidth}get clientHeight(){return this.ele.clientHeight}get offsetWidth(){return this.ele.offsetWidth}get offsetHeight(){return this.ele.offsetHeight}get outerWidth(){let e=getComputedStyle(this.ele);return this.ele.offsetWidth+parseInt(e["margin-left"])+parseInt(e["margin-right"])}get outerHeight(){let e=getComputedStyle(this.ele);return this.ele.offsetHeight+parseInt(e["margin-top"])+parseInt(e["margin-bottom"])}is(e){return v(this.ele,e)}remove(){const{parent:e}=this;e&&e.splice(e.indexOf(this),1)}clone(e=!0){return Ie(this.ele.cloneNode(e))}wrap(e){const t=Ve(e),{ele:n}=this;if(!n.parentNode)throw r("xhear_wrap_no_parent");return n.parentNode.insertBefore(t.ele,n),n.__internal=1,t.ele.appendChild(n),delete n.__internal,this}unwrap(){const{ele:e}=this,t=e.parentNode;if(t.children.length>1)throw r("xhear_unwrap_has_siblings");return e.__internal=1,t.parentNode.insertBefore(e,t),t.remove(),delete e.__internal,this}}const De=F.prototype,Be=Re.prototype;Be.extend({get:De.get,set:De.set,toJSON:De.toJSON,toString:De.toString,...L,...le,...ae,...ie,...xe},{enumerable:!1}),Be.extend(Te);const Ie=e=>e?e.__xhear__?e.__xhear__:new Re({ele:e}):null,qe=document.createElement("template"),Ve=(e,t)=>{if(e instanceof Re)return e;if(e instanceof Node||e===window)return Ie(e);switch(i(e)){case"object":return(e=>{const t={...e};if(!e.tag)return null;const r=document.createElement(e.tag);delete t.tag;const n=Ie(r);return Object.assign(n,t),n})(e);case"string":return(e=>{qe.innerHTML=e;const t=qe.content.children[0]||qe.content.childNodes[0];return qe.innerHTML="",Ie(t)})(e)}},Fe=e=>{e.__revokes&&Array.from(e.__revokes).forEach((e=>e&&e())),e.childNodes&&Array.from(e.childNodes).forEach((e=>{Fe(e)}));const t=e?.shadowRoot?.__revokes;t&&[...t].forEach((e=>e()))};function We(e){if("string"===i(e)&&!/<.+>/.test(e)){const t=document.querySelector(e);return Ie(t)}return Ve(e)}return Object.defineProperties(We,{extensions:{value:{}}}),Object.assign(We,{stanz:pe,render:Q,convert:ne,register:Ae,nextTick:f,fn:Re.prototype,all:e=>x(document,e).map(Ie),frag:()=>We(document.createDocumentFragment())}),We}));
//# sourceMappingURL=xhear.min.js.map
